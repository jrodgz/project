<!DOCTYPE html>
<html>
    <head>
        <title>Start Page</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="css/boostrapflat.css">
        <link rel="stylesheet" type="text/css" href="css/dashboard.css">
        <link rel="stylesheet" type="text/css" href="css/c3.css">
        <!--<script data-main="js/main" src="js/require.js"></script>-->
        <script src="js/libs/d3.js"></script>
        <script src="js/libs/jquery-2.2.1.js"></script>
        <script src="js/libs/moment.js"></script>
        <script src="js/libs/holder.js"></script>
        <script src="js/libs/c3.js"></script>
        <script src="js/libs/underscore.js"></script>
        <script src="js/TaggedMemmentos.js"></script>
        <script src="js/Memento.js"></script>
        <script src="js/visualization.js" ></script>
        <script src="js/extractor.js"></script>
        <script src="js/gui.js"></script>
        <script src="js/global.js"></script>
        <script src="js/sheetparser.js"></script>
        <script src="js/drawing.js"></script>
    </head>
    <body>
    <nav role="navigation" class="navbar navbar-default navbar-static-top">
        <div class="container-fluid">
            <p class="navbar-text">Controls</p>
            <button type="button" class="btn btn-default navbar-btn">Mementos</button>
            <button type="button" class="btn btn-default navbar-btn">Tags</button>
            <button type="button" class="btn btn-default navbar-btn">Resources</button>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">

            <div class="col-sm-8">
                <div class="chart-wrapper">
                    <div class="chart-title">
                        Tags
                    </div>
                    <div class="chart-stage" id="chart-results">

                    </div>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="chart-wrapper">
                    <div class="chart-title">
                        Updates
                    </div>
                    <div class="chart-stage">
                        <div  class="h-scroll" id="chart-update">

                        </div>
                    </div>
                    <div class="chart-notes">
                        Notes go down here
                    </div>
                </div>
            </div>

        </div>


        <div class="row">

            <div class="col-sm-4">
                <div class="chart-wrapper">
                    <div class="chart-title">
                        Impressions by advertiser
                    </div>
                    <div class="chart-stage">
                        <div id="chart-03"></div>
                    </div>
                    <div class="chart-notes">
                        Notes go down here
                    </div>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="chart-wrapper">
                    <div class="chart-title">
                        Impressions by device
                    </div>
                    <div class="chart-stage">
                        <div id="chart-04"></div>
                    </div>
                    <div class="chart-notes">
                        Notes go down here
                    </div>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="chart-wrapper">
                    <div class="chart-title">
                        Impressions by country
                    </div>
                    <div class="chart-stage">
                        <div id="chart-05"></div>
                    </div>
                    <div class="chart-notes">
                        Notes go down here
                    </div>
                </div>
            </div>

        </div>

        <div class="row">
            <div class="col-sm-3">
                <div class="chart-wrapper">
                    <img data-src="holder.js/100%x150/white">
                </div>
            </div>
            <div class="col-sm-3">
                <div class="chart-wrapper">
                    <img data-src="holder.js/100%x150/white">
                </div>
            </div>
            <div class="col-sm-3">
                <div class="chart-wrapper">
                    <img data-src="holder.js/100%x150/white">
                </div>
            </div>
            <div class="col-sm-3">
                <div class="chart-wrapper">
                    <img data-src="holder.js/100%x150/white">
                </div>
            </div>
        </div>
    </div>


        <!--<div class="content" id="results">

            <div class="visiualization"></div>

            <div class="controls">
                <button id="controlsButton"></button>
            </div>

        </div>
        <div class="errorDiv" id="current_status"></div>-->
        <script src="js/libs/bootstrap.js"></script>
        <script>
            var spreadsheetID = "1O0JIuvFus0U-WYZ_3IJBU-PB3amRQhfH63hAq8dY6aE";
            var url = "https://spreadsheets.google.com/feeds/list/" + spreadsheetID + "/od6/public/values?alt=json";
            var statusDiv = $('#chart-update');
            gui.constructor.prepareMenuItems('items');
            gui.constructor.setLoadigScreen('chart-results');
            var sp = new sheetParser(url,statusDiv);
            var resultsDiv = $("#chart-results");
            resultsDiv.css("height","400px");
            //
            /*
             width: 89%; 400px
             height: 95%; 400px
             */
//            resultsDiv.css("width","89%");
//            resultsDiv.css("height","100px");
//            resultsDiv.css("background-image", "url(images/loading.gif)");
//            resultsDiv.css("background-repeat", "no-repeat");
//            resultsDiv.css("background-position", "center");
//            resultsDiv.css("height","400");
//            var svg = d3.select("#chart-results").append("svg").attr('width', $(resultsDiv).innerWidth())
//                    .attr('height', $(resultsDiv).innerHeight());
//            var container = drawing.createZoomableContainer(svg,$(resultsDiv).innerWidth(),$(resultsDiv).innerHeight());
//            var width = $(resultsDiv).innerWidth(),height=$(resultsDiv).innerHeight();
//            var imageList = ["images/page0.png","images/page1.png","images/page2.png",
//                "images/page3.png","images/page4.png","images/page5.png"];
//            var igroup = new drawing.ImageGroup(resultsDiv,imageList);
////            igroup.paginate(imageList.length / 2);
//            igroup.resize(128, 128);
            sp.loadSheet().then(function (data) {
                var tags = _.map(data,function (tm) {
                    return tm.tags;
                });
                tags = _.flatten(tags);
                console.log(tags);
//                drawing.WordGroup(container,tags,width,height);
                var histdata = {
                    cols: []
                };
                data.forEach(function (tm) {
                    console.log(tm);
                    var d = [];
                    d.push(tm.title);
                    d.push(tm.mementos.length);
                    histdata.cols.push(d);
                });


             var chart = c3.generate({
                 bindto: "#chart-results",
                 data: {
                     columns: histdata.cols,
                     type: 'bar'
                 },
                 bar: {
                     width: {
                         ratio: 0.5
                     }
                 }

              });
            });

        </script>

    </body>
</html>
